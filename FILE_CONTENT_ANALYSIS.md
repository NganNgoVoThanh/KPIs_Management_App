# ğŸ“Š PHÃ‚N TÃCH CHI TIáº¾T FILE: 2025 KPI Setting Template_System.xls

**NgÃ y phÃ¢n tÃ­ch:** 19/12/2024
**File path:** `download/2025 KPI Setting Template_System.xls`

---

## ğŸ“‹ Tá»”NG QUAN Cáº¤U TRÃšC FILE

| ThÃ´ng tin | GiÃ¡ trá»‹ |
|-----------|---------|
| **Sheet name** | KPI Template |
| **Tá»•ng sá»‘ rows** | 21 rows (0-20) |
| **Range** | A1:V21 |
| **Header row** | Row 11 |
| **Data rows** | Rows 13-20 |
| **Section headers** | Rows 12, 18 |

---

## ğŸ” PHáº¦N 1: METADATA SECTION (Rows 0-10)

### Row 0: Document Title
```
Col 1: "Target Setting and Review Document"
Col 7: "Overall Evaluation Achievement:"
Col 8: 60.0%
```

### Row 1: Personal Info Line 1
```
Col 0: "Full name:"
Col 2: "Employee Code:"
```
**Note:** CÃ¡c giÃ¡ trá»‹ thá»±c táº¿ KHÃ”NG cÃ³ trong file máº«u nÃ y (Ã´ trá»‘ng)

### Row 2: Personal Info Line 2
```
Col 0: "Location:"
Col 2: "Joining Date:"
```

### Row 3: Department & Manager
```
Col 0: "Department:"
Col 2: "Line Manager:"
```

### Row 4: Job Title & Ranking
```
Col 0: "Job Tittle:"  [LÆ°u Ã½: Typo "Tittle" thay vÃ¬ "Title"]
Col 2: "KPI Ranking:"
```

### Row 5: Section Summary Header
```
Col 0: "Part of Target Setting"
Col 7: "Standards"
Col 8: "Weighted"
Col 9: "Score"
```

### Rows 6-9: Section Overview
```
Row 6:  1. BUSINESS OBJECTIVE               | 50% | 80.0% | 40%
Row 7:  2. INDIVIDUAL DEVELOPMENT OBJECTIVES | 100% | 20.0% | 20%
Row 8:  3. LEVEL OF CORE VALUES DEVELOPMENT  | 0%   | 0.0%  | 0%
Row 9:  4. MANAGEMENT CRITERIA               | 0%   | 0.0%  | 0%
```

### Row 10: Main Title
```
"2025 TARGETS SETTING"
```

---

## ğŸ“Š PHáº¦N 2: KPI DATA SECTION (Rows 11-20)

### Row 11: HEADER ROW (Column Names)
```
Col 0: KPI Group/OGSM
Col 1: KPI Name
Col 2: Target
Col 3: Unit
Col 4: Weight (a) (Max 100%)
Col 5: KPI Type
Col 6: Employee Explanation of Results
Col 7: Manager comments
Col 8: Achieved (b)
Col 9: Score (a) * (b)
```

---

## ğŸ“ˆ SECTION 1: BUSINESS OBJECTIVES (Rows 12-17)

### Row 12: Section Header
```
"1. BUSINESS OBJECTIVES (Max 5) 80%"
Score: 50%
```

### Row 13: KPI #1 - Improve Productivity
```
KPI Group/OGSM: Improve Productivity
KPI Name: Name of target:Increase 01 kg/manual peeling worker ( FPM Productivity)
          based on baseline 2024 ( average productiivty/FTE)
          (LA: 10.8, PT: 10.2, TN: 7.8)
          Measure : Each factory get 33% weight
                    increase >=1kg :  100%
                    increase <1kg - 0.5kg : linear
                    increase <0.5kg: 0%
          Evidence: Monthly CnB Master Data for incentive
Target: 1
Unit: kg
Weight: 20%
KPI Type: IV
Achieved: 50.0%
Score: 10%
```

### Row 14: KPI #2 - Improve Training Service/Quality
```
KPI Group/OGSM: Improve Training Service/ Quality
KPI Name: Name of target: Achieve Evaluation score >= 4.2/5 (exclude Orientation courses)
          Baseline 2024 : 4.6/5
          Measure : Each factory get 33%
                    >= 4.2/5 :  100%
                    >4 - <4.25: linear
                    Below 4/5: 0%
          Evidence: Training Master data
Target: 4.6
Unit: Score
Weight: 20%
KPI Type: IV
Achieved: 100.0%
Score: 20%
```

### Row 15: KPI #3 - Organization Project Implement
```
KPI Group/OGSM: Organization Project Implement
KPI Name: Name of target: Build & mapping competencies/career roadmap of 5 Depts on time
          Sales : before 30 Apr 2025
          HR : before 30 May 2025
          Technical/ Maintenance/ HSE : before 30 Jun 2025
          Measure: minus 5% weight /Department for uncomplete
          Evidence: Approved by HoD/ OD & HRD
Target: 100%
Unit: complete
Weight: 20%
KPI Type: III
Achieved: 0.0%
Score: 0%
```

### Row 16: KPI #4 - Employee Engagement Survey
```
KPI Group/OGSM: Employee Engagement Survey
KPI Name: Name of target: Implement Engagement Survey for all factories before 30 Jun 2025
          Achieve Survey :  100%
          Uncomplete: 0%
          Evidence: Email - announcement survey implementation
Target: 80%
Unit: complete
KPI Type: IV
Achieved: 100.0%
Score: 20%
```

### Row 17: KPI #5 - Talent Development Program
```
KPI Group/OGSM: Talenr Development Program  [LÆ°u Ã½: Typo "Talenr"]
KPI Name: Name of terget: Complete Talent Pool List  for all factories before 31 May 2025
          Measure:  complete: 100%
                    Uncomplete: 0%
          Evidence: email approval for Talent Pool list by LMT/Board
Target: 100%
Unit: complete
Weight: 20%
KPI Type: III
Achieved: 0.0%
Score: 0%
```

---

## ğŸ“š SECTION 2: INDIVIDUAL DEVELOPMENT OBJECTIVES (Rows 18-20)

### Row 18: Section Header
```
"2. INDIVIDUAL DEVELOPMENT OBJECTIVES (Max 2) 20%"
```

### Row 19: KPI #6 - Learning Hours
```
KPI Group/OGSM: Learning Hours
KPI Name: All employees: 08 learning hours, include compulsory training + elective courses
          Achieve 8 learning hours and above: 100%
          Achieve below 8 learning hours: 0%
          Evidence: Talent Development Master data
Target: 08
Unit: Hour
Weight: 50%
KPI Type: IV
Achieved: 100.0%
Score: 50%
```

### Row 20: KPI #7 - Training/Coaching Hours
```
KPI Group/OGSM: Training/Coaching Hours
KPI Name: Managers: 3 training or Coaching hours (include compulsory training)
          Achieve 3 training hours and above: 100%
          Achieve below 3 training hours and above: 0%
          Evidence: Talent Development Master data
Target: 03
Unit: Hour
Weight: 50%
KPI Type: III
Achieved: 100.0%
Score: 50%
```

---

## ğŸ“Š Tá»”NG Káº¾T PHÃ‚N Bá»” KPIs

### Theo Section:
| Section | Sá»‘ lÆ°á»£ng KPIs | Weight tá»•ng | KPI IDs |
|---------|--------------|-------------|---------|
| **1. Business Objectives** | 5 KPIs | 100% (20% x 5) | #1-#5 |
| **2. Individual Development** | 2 KPIs | 100% (50% x 2) | #6-#7 |
| **3. Core Values** | 0 KPIs | 0% | - |
| **4. Management Criteria** | 0 KPIs | 0% | - |
| **Tá»”NG** | **7 KPIs** | - | - |

### Theo KPI Type:
| KPI Type | Sá»‘ lÆ°á»£ng | KPI IDs |
|----------|----------|---------|
| **Type I** | 0 | - |
| **Type II** | 0 | - |
| **Type III** | 3 | #3, #5, #7 |
| **Type IV** | 4 | #1, #2, #4, #6 |

---

## ğŸ¯ Káº¾T QUáº¢ PARSING Dá»° KIáº¾N

Sau khi upload file nÃ y vÃ o Bulk Upload, há»‡ thá»‘ng sáº½:

âœ… **Template Type Detected:** "2025 Targets Setting Template"
âœ… **Header Row:** Row 11
âœ… **Total KPI Entries:** 7 entries
âœ… **Skipped Rows:** 2 rows (Row 12, Row 18 - section headers)

### Danh sÃ¡ch 7 KPIs Ä‘Æ°á»£c extract:

| STT | OGSM/KPI Group | KPI Name (rÃºt gá»n) | Type | Unit | Weight |
|-----|----------------|-------------------|------|------|--------|
| 1 | Improve Productivity | Increase 01 kg/manual peeling worker... | IV | kg | 20% |
| 2 | Improve Training Service/Quality | Achieve Evaluation score >= 4.2/5... | IV | Score | 20% |
| 3 | Organization Project Implement | Build & mapping competencies... | III | complete | 20% |
| 4 | Employee Engagement Survey | Implement Engagement Survey... | IV | complete | 20% |
| 5 | Talent Development Program | Complete Talent Pool List... | III | complete | 20% |
| 6 | Learning Hours | 08 learning hours... | IV | Hour | 50% |
| 7 | Training/Coaching Hours | 3 training or Coaching hours... | III | Hour | 50% |

---

## âš ï¸ LÆ¯U Ã QUAN TRá»ŒNG

### 1. Metadata Trá»‘ng
File máº«u nÃ y **KHÃ”NG chá»©a** giÃ¡ trá»‹ thá»±c táº¿ cho:
- Full name
- Employee Code
- Department
- Job Title
- Location
- Joining Date
- Line Manager
- KPI Ranking

â†’ CÃ¡c trÆ°á»ng nÃ y sáº½ Ä‘á»ƒ **trá»‘ng** khi import vÃ o há»‡ thá»‘ng.

### 2. Typos trong File
- "Talenr" â†’ nÃªn lÃ  "Talent"
- "Job Tittle" â†’ nÃªn lÃ  "Job Title"
- "terget" â†’ nÃªn lÃ  "target"

### 3. Section 3 & 4 Rá»—ng
- Section 3 (Core Values Development): 0%
- Section 4 (Management Criteria): 0%

â†’ KhÃ´ng cÃ³ KPI nÃ o trong 2 sections nÃ y.

---

## ğŸ”§ Váº¤N Äá»€ ÄÃƒ FIX

### Váº¥n Ä‘á» trÆ°á»›c Ä‘Ã¢y:
âŒ File bá»‹ nháº­n diá»‡n sai thÃ nh **"Legacy Target Setting"**
âŒ Hiá»ƒn thá»‹ **"0 KPI entries"** do khÃ´ng tÃ¬m tháº¥y cá»™t "Main KPI"/"Sub-KPI"

### Giáº£i phÃ¡p Ä‘Ã£ Ã¡p dá»¥ng:
âœ… TÄƒng Ä‘á»™ strict cho Template 1 detection
âœ… YÃªu cáº§u pháº£i cÃ³ marker "Main KPI" HOáº¶C "Sub-KPI" HOáº¶C "Target or KPI"
âœ… Template 4 Ä‘Æ°á»£c Æ°u tiÃªn khi khÃ´ng cÃ³ legacy markers
âœ… Fix regex KPI Type Ä‘á»ƒ nháº­n diá»‡n Ä‘Ãºng IV (khÃ´ng pháº£i IIII)

---

## ğŸ“ HÆ¯á»šNG DáºªN Sá»¬ Dá»¤NG

1. **Login vá»›i Admin account:**
   - Email: `admin@intersnack.com.vn`
   - Password: `123456`

2. **Navigate:** Admin â†’ KPI Library â†’ Bulk Upload tab

3. **Upload file:** Click "Browse" â†’ chá»n `2025 KPI Setting Template_System.xls`

4. **Verify detection:**
   - âœ… Template type: "2025 Targets Setting Template"
   - âœ… Total entries: 7 KPIs
   - âœ… Preview shows KPI names correctly

5. **Submit:** Click "Upload Templates" button

6. **Approve:** Review upload history â†’ Approve Ä‘á»ƒ import vÃ o database

---

**Last updated:** 19/12/2024
**Script version:** test-full-parsing.js v1.0
